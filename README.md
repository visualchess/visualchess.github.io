# visualchess
Обучающая программа для игры в шахматы на базе шахматной литературы

## Запуск локального сервера

Для запуска проекта локально без проблем с CORS/CORB:

1. Установите зависимости:
```bash
npm install
```

2. Запустите сервер:
```bash
npm start
```

3. Откройте в браузере: http://localhost:3000

Сервер автоматически раздаёт все статические файлы и решает проблемы с CORS/CORB.

## Протокол обмена с Stockfish

Приложение поддерживает протоколирование всех сообщений между GUI и движком Stockfish. Это полезно для отладки и анализа работы движка.

**Протокол включен по умолчанию** и отображается на странице при загрузке приложения.

### Изменение настроек протокола

Протокол можно включить или отключить через консоль разработчика браузера (F12 или Ctrl+Shift+I):

**Включить:**
```javascript
DEBUG_STOCKFISH_PROTOCOL = true
```

**Отключить:**
```javascript
DEBUG_STOCKFISH_PROTOCOL = false
```

### Изменение значения по умолчанию

Чтобы изменить значение по умолчанию (включено/выключено), отредактируйте файл `app.js`:

```javascript
// Строка ~7-9 в app.js
if (globalThis.DEBUG_STOCKFISH_PROTOCOL === undefined) {
    globalThis.DEBUG_STOCKFISH_PROTOCOL = true;  // Измените на false для отключения по умолчанию
}
```

### Что показывает протокол

Протокол отображает:
- **Все команды**, отправляемые GUI в Stockfish (помечены символом `>`)
- **Все ответы** от Stockfish (помечены символом `<`)
- **Текущее время** с миллисекундами в формате `HH:MM:SS.mmm`
- **Относительное время** от начала протоколирования в формате `+XXX.XXms`

### Формат записей

Каждая строка протокола имеет формат:
```
[14:23:45.123 | +0.00ms] > uci
[14:23:45.234 | +111.11ms] < id name Stockfish 16.1
[14:23:45.345 | +222.22ms] < id author the Stockfish developers
```

Где:
- `[14:23:45.123 | +0.00ms]` - метка времени (текущее время | относительное время)
- `>` - команда от GUI к Stockfish
- `<` - ответ от Stockfish к GUI
- Далее следует текст сообщения

### Использование

Протокол можно скопировать целиком (выделить текст в текстовом поле и скопировать) для последующего анализа в любом текстовом редакторе.

## Обновление версии

Версия проекта автоматически вычисляется на основе количества коммитов в репозитории (формат: `0.№`, где № - количество коммитов + 1).

Для обновления версии выполните:
```bash
npm run update-version
```

Или напрямую:
```bash
node scripts/update-version.js
```

Версия будет записана в файл `version.txt` и отображается на странице приложения.
